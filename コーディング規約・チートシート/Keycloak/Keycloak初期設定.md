---
作成日: 2025-05-27
tags:
  - Keycloak
  - 認証
  - 認可
---
# Keycloakn初期設定
---
## ログイン
- コンテナの起動に成功したら、以下のアドレスにアクセスする。
```
http://localhost:8180/admin
```

- ログインID: `admin` パスワード: `admin_password` でログインする。
---
## 日本語化
- `Configure`項目の`Realm settings`にアクセスする。

![](Pasted%20image%2020250522143805.png)

- `Localization`タブを開き、`Internationalization`を`Enabled`に変更する。
- `Supported locales`と`Default locale`を共に`Japanese`に変更する。
- AI等に質問すると英語名で項目を説明するため、この設定は最後に行ったほうが良い。
---
## 管理者ユーザーの作成
- 永久的な管理者ユーザーを作成していない場合、以下のメッセージが表示される。
  「一時的な管理者ユーザーとしてログインしています。セキュリティーを強化するには、永続的な管理者アカウントを作成し、一時的なアカウントを削除してください。」
- このメッセージを削除するために永続的な管理者アカウントを作成する。

### ユーザー作成
- 必要事項を入力後、作成
![](Pasted%20image%2020250527135247.png)

### パスワード設定
- ユーザー作成後、クレデンシャルでパスワードを設定する。
- このとき、一時的をオフにしておく
![](Pasted%20image%2020250527135417.png)

### ロール設定
- Assign role
![](Pasted%20image%2020250527135506.png)

- クライアントによるフィルターを「Filter by realm roles」に変更
![](Pasted%20image%2020250527135637.png)

- 「admin」を選択して「Assign」
![](Pasted%20image%2020250527135732.png)

- 作成した「master_admin」でログイン後、一時ユーザーのadminを削除する。


---

## レルムの作成
- `Manage realms`ページにアクセスし、`レルムの作成`ボタンをクリックする。
![](Pasted%20image%2020250522150720.png)

- レルム名を入力して`作成`ボタンをクリックして作成する。
- ここでは`miya-realm`とした。
---
## 作成したレルムの日本語化
- `Current Realm`が`miya-realm`であることを確認し、先程説明した方法で日本語化する。
- 新しく作成したレルムで日本語化しないと、ログイン画面などが日本語化されない。
---
## クライアントの作成
- `Current Realm`が`miya-realm`であることを確認し、クライアントを作成する。

### `General settings`
- `クライアントタイプ`: `OpenID Connect`
- `クライアントID`: 任意の文字列
- 名前: 任意
- 説明: 任意
- 常にコンソールに表示: `ON`

### 機能設定
- クライアント認証: ON
- スタンダードフロー: ON
- ダイレクトアクセスグラント: ON
- 上記以外はOFF

### アクセス設定

![](Pasted%20image%2020250522161533.png)

---


